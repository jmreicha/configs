### Prompt

# The format layout for the prompt is as follows:

# left side
# fill
# right prompt info
# right prompt tools and versions
# prompt character

# Commands may be slower in restricted environments, e.g. containers
command_timeout = 1000

format = """
$username$hostname$directory$git_branch$git_commit$git_state$git_status\
$fill\
$jobs$status$cmd_duration\
$terraform${custom.terraform}${custom.terragrunt}$kubernetes$python$aws$nodejs$docker_context$golang${custom.loadavg}$memory_usage
$character
"""

[fill]
symbol = " "

[character]
success_symbol = "[❯](green)"

### Left prompt

[username]
# TODO username - sudo prompt only
disabled = true
style_user = "#d3b987"
format = " [$user@]($style)"

[hostname]
disabled = true
ssh_only = true
style = "#d3b987"
format = "[$hostname]($style)[ ](#767676)"

[directory]
read_only = " "
truncation_length = 2
truncate_to_repo = false
repo_root_style = "#0087af"
fish_style_pwd_dir_length = 2
style = "#00afff"
# TODO left padding doesn't show up in git repos with repo style on
format = "[  $path]($style)[$read_only]($read_only_style)"

[git_branch]
symbol = "  "
style = "green"
format = "[ ](#767676)[$symbol$branch]($style)"

[git_status]
stashed = "[*${count}](blue) "
modified = "[!${count}](yellow) "
staged = "[+${count}](green) "
untracked = "[?${count}](blue) "
deleted = "[-${count}](red) "
format = " ([$stashed$modified$staged$untracked $ahead_behind]($style))"
#format = " ([$all_status $ahead_behind]($style))"

### Right prompt info

[jobs]
disabled = false
format = "[$number]($style)"

[status]
disabled = false
map_symbol = false
format = "[$symbol$status]($style) "

[cmd_duration]
style = "#a8a8a8"
format = "[ ](#767676)[$duration ]($style) "

### Right prompt tools and versions

[terraform]
# We disable the native tf plugin because it is much slower than tfenv
disabled = true
format = "[ ](#767676)[tf $version]($style) "
detect_extensions = ["tf"]
detect_files = ["terragrunt.hcl"]

[kubernetes]
format = '[$symbol$context( \($namespace\))]($style) '

[golang]
symbol = " "
format = "[$symbol($version)]($style) "

[nodejs]
format = "[$symbol($version)]($style) "

[python]
symbol = " "
format = '[${symbol}${pyenv_prefix}(${version})(\($virtualenv\))]($style) '

[aws]
disabled = false
symbol = " "
format = '([ ](#767676)[$symbol$profile(\[$duration\])]($style) )'

[conda]
symbol = " "

[docker_context]
symbol = " "
format = "[ ](#767676)[$symbol$context]($style) "

[nix_shell]
symbol = " "

[memory_usage]
disabled = false
threshold = -1
symbol = ""
style = "#5f8787"
format = "[ ](#767676)[$ram_pct $symbol]($style)"

[shlvl]
disabled = true

### Custom plugins

[custom.terragrunt]
description = "Shows the currently active tgenv Terragrunt version"
command = "cat $(pwd)/.terragrunt-version || cat $(git rev-parse --show-toplevel)/.terragrunt-version || cat ~/.tgenv/version"
files = ["terragrunt.hcl"]
style = "#0bb9f2"
format = "[ ](#767676)[tg $output]($style) "

[custom.terraform]
description = "Shows the currently active tfenv Terraform version"
command = "cat $(pwd)/.terraform-version || cat $(git rev-parse --show-toplevel)/.terraform-version || cat ~/.tfenv/version"
extensions = ["tf"]
files = ["terragrunt.hcl"]
style = "#7b42bc"
format = "[ ](#767676)[tf $output]($style) "

[custom.loadavg]
description = "Show load average"
command = "cat /proc/loadavg | cut -d' ' -f 2"
style = "#5f8787"
format = "[ ](#767676)[$output ]($style) "
when = "true"
